<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SL Skills Hub</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #fff;
    }
    header {
      background-color: #007BFF;
      color: white;
      padding: 15px;
      text-align: center;
      position: relative;
    }
    header img.logo {
      width: 40px;
      height: 40px;
      vertical-align: middle;
      margin-right: 10px;
    }
    header h1 {
      display: inline;
      font-size: 28px;
      margin: 0;
    }
    header p {
      margin: 5px 0 0;
      font-size: 16px;
      font-weight: bold;
    }
    #auth-section {
      position: absolute;
      top: 15px;
      left: 15px;
      text-align: left;
    }
    #auth-section img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: block;
      margin-bottom: 5px;
    }
    #auth-section button {
      display: block;
      margin-top: 5px;
      background-color: white;
      color: #007BFF;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    #auth-section button:hover {
      background-color: #f0f0f0;
    }
    #searchBar {
      width: 60%;
      padding: 10px;
      margin: 15px auto;
      display: block;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    #addSkillForm {
      text-align: center;
      margin: 20px;
    }
    #addSkillForm input, #addSkillForm select {
      display: block;
      margin: 10px auto;
      padding: 10px;
      width: 50%;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    #addSkillForm button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
    #skillsContainer {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 20px;
    }
    .skill-card {
      background: white;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      margin: 10px;
      width: 250px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .skill-card img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin-bottom: 10px;
    }
    .skill-card button {
      margin: 5px;
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    .skill-card button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>

<header>
  <!-- ✅ Your site logo -->
  <img src="sl-skillshub-logo.png" alt="Logo" class="logo"> 
  <h1>SL Skills Hub</h1>
  <p>find talented people near you</p>
  <div id="auth-section">
    <img id="userPic" src="" style="display:none;">
    <p id="userName"></p>
    <button id="loginBtn">Login with Google</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
  </div>
</header>

<input type="text" id="searchBar" placeholder="Search skills...">

<div id="addSkillForm">
  <input type="text" id="name" placeholder="Your Name">
  <input type="text" id="skill" placeholder="Your Skill">
  <input type="text" id="location" placeholder="Your Location">
  <input type="text" id="whatsapp" placeholder="WhatsApp Contact">
  <!-- ✅ Upload profile picture -->
  <input type="file" id="profilePic" accept="image/*">
  <button onclick="addSkill()">Add Skill</button>
</div>

<div id="skillsContainer"></div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBWy9ffEDL3OugOpRbHrvDjGbQ3fkPGU4Y",
    authDomain: "sl-skills-hub.firebaseapp.com",
    projectId: "sl-skills-hub",
    storageBucket: "sl-skills-hub.appspot.com",
    messagingSenderId: "125049368940",
    appId: "1:125049368940:web:76d4a47aa9eb7c43914349"
  };
  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();
  const storage = firebase.storage();

  let currentUser = null;

  // ✅ Google Login
  document.getElementById("loginBtn").addEventListener("click", async () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    try {
      const result = await auth.signInWithPopup(provider);
      currentUser = result.user;
      document.getElementById("userPic").src = currentUser.photoURL;
      document.getElementById("userPic").style.display = "block";
      document.getElementById("userName").innerText = currentUser.displayName;
      document.getElementById("loginBtn").style.display = "none";
      document.getElementById("logoutBtn").style.display = "block";
    } catch (error) {
      console.error("Login failed", error);
    }
  });

  document.getElementById("logoutBtn").addEventListener("click", () => {
    auth.signOut();
    currentUser = null;
    document.getElementById("userPic").style.display = "none";
    document.getElementById("userName").innerText = "";
    document.getElementById("loginBtn").style.display = "block";
    document.getElementById("logoutBtn").style.display = "none";
  });

  // ✅ Add Skill
  async function addSkill() {
    const name = document.getElementById("name").value;
    const skill = document.getElementById("skill").value;
    const location = document.getElementById("location").value;
    const whatsapp = document.getElementById("whatsapp").value;
    const fileInput = document.getElementById("profilePic");

    let imageUrl = "default.png"; // fallback

    if (fileInput.files.length > 0) {
      const file = fileInput.files[0];
      const storageRef = storage.ref("profilePics/" + Date.now() + "-" + file.name);
      await storageRef.put(file);
      imageUrl = await storageRef.getDownloadURL();
    } else if (fileInput.dataset.currentImage) {
      // ✅ Keep old picture on edit
      imageUrl = fileInput.dataset.currentImage;
    }

    saveSkill(name, skill, location, whatsapp, imageUrl);
    fileInput.value = ""; // reset upload
  }

  function saveSkill(name, skill, location, whatsapp, imageUrl) {
    const container = document.getElementById("skillsContainer");
    const card = document.createElement("div");
    card.className = "skill-card";
    card.innerHTML = `
      <img src="${imageUrl}" alt="Profile Picture">
      <h3>${name}</h3>
      <p><strong>Skill:</strong> ${skill}</p>
      <p><strong>Location:</strong> ${location}</p>
      <p><strong>WhatsApp:</strong> ${whatsapp}</p>
      <button onclick="editSkill(this)">Edit</button>
      <button onclick="deleteSkill(this)">Delete</button>
    `;
    container.appendChild(card);
  }

  function editSkill(button) {
    const card = button.parentElement;
    const name = card.querySelector("h3").innerText;
    const skill = card.querySelector("p:nth-of-type(1)").innerText.replace("Skill: ", "");
    const location = card.querySelector("p:nth-of-type(2)").innerText.replace("Location: ", "");
    const whatsapp = card.querySelector("p:nth-of-type(3)").innerText.replace("WhatsApp: ", "");
    const imageUrl = card.querySelector("img").src;

    document.getElementById("name").value = name;
    document.getElementById("skill").value = skill;
    document.getElementById("location").value = location;
    document.getElementById("whatsapp").value = whatsapp;
    
    // ✅ keep existing picture unless new one uploaded
    document.getElementById("profilePic").dataset.currentImage = imageUrl;
    
    card.remove();
  }

  function deleteSkill(button) {
    button.parentElement.remove();
  }
</script>

</body>
</html>
