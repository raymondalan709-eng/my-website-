<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SL Skills Hub</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #fff;
    }
    header {
      background: #007bff;
      color: white;
      padding: 15px;
      text-align: center;
    }
    header h1 {
      margin: 0;
    }
    header p {
      font-size: 18px;
      font-weight: bold;
    }
    #authSection {
      position: absolute;
      top: 10px;
      left: 10px;
      text-align: left;
    }
    #authSection img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: block;
      margin-bottom: 5px;
    }
    #authSection p {
      margin: 0;
      font-size: 14px;
      color: black;
    }
    #searchBar {
      margin-top: 10px;
      padding: 8px;
      width: 60%;
      max-width: 400px;
      border: none;
      border-radius: 5px;
    }
    #addSkillBtn {
      background: white;
      color: #007bff;
      border: none;
      padding: 8px 16px;
      margin-left: 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    #skillForm {
      display: none;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid #ddd;
      width: 300px;
      border-radius: 8px;
      background: #f9f9f9;
    }
    #skillForm input, #skillForm select {
      width: 100%;
      margin: 8px 0;
      padding: 8px;
    }
    .skill-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      margin: 10px auto;
      padding: 15px;
      width: 90%;
      max-width: 400px;
      background: white;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    .skill-card img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
    }
    .skill-card button {
      margin-top: 8px;
      margin-right: 5px;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .editBtn { background: orange; color: white; }
    .deleteBtn { background: red; color: white; }
  </style>
</head>
<body>
  <header>
    <h1>SL Skills Hub</h1>
    <p>find talented people near you</p>
    <input type="text" id="searchBar" placeholder="Search skills...">
    <button id="addSkillBtn">Add Skill</button>
  </header>

  <div id="authSection">
    <img id="userPic" style="display:none;">
    <p id="userName"></p>
    <button id="loginBtn">Login with Google</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
  </div>

  <div id="skillForm">
    <input type="text" id="name" placeholder="Your Name">
    <input type="text" id="skill" placeholder="Your Skill">
    <input type="text" id="location" placeholder="Your Location">
    <input type="text" id="whatsapp" placeholder="WhatsApp Contact">
    <select id="category"></select>
    <input type="text" id="profilePic" placeholder="Profile Picture URL">
    <button id="saveSkillBtn">Save Skill</button>
  </div>

  <div id="skillsList"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

  <script>
    // Firebase config
   const firebaseConfig = {
  apiKey: "AIzaSyBWy9ffEDL3OugOpRbHrvDjGbQ3fkPGU4Y",
  authDomain: "sl-skills-hub.firebaseapp.com",
  projectId: "sl-skills-hub",
  storageBucket: "sl-skills-hub.firebasestorage.app",
  messagingSenderId: "125049368940",
  appId: "1:125049368940:web:76d4a47aa9eb7c43914349"
};
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const adminUID = "I5WY1FJzNibUDOCzCBdGWPtX9Nj1";

    // Elements
    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const userPic = document.getElementById("userPic");
    const userName = document.getElementById("userName");
    const addSkillBtn = document.getElementById("addSkillBtn");
    const skillForm = document.getElementById("skillForm");
    const saveSkillBtn = document.getElementById("saveSkillBtn");
    const skillsList = document.getElementById("skillsList");
    const categorySelect = document.getElementById("category");
    const searchBar = document.getElementById("searchBar");

    let currentUser = null;
    let editingId = null;

    // Aâ€“Z categories
    const categories = [
      "Accounting", "Agriculture", "Architecture", "Art", "Automotive",
      "Banking", "Barbering", "Beauty", "Business", "Carpentry",
      "Catering", "Cleaning", "Construction", "Cooking", "Crafts",
      "Data Analysis", "Design", "Driving", "Education", "Electrician",
      "Engineering", "Event Planning", "Fashion", "Film", "Fitness",
      "Gardening", "Graphics", "Hairdressing", "Health", "Hospitality",
      "ICT", "Journalism", "Law", "Logistics", "Marketing",
      "Mechanic", "Medicine", "Music", "Photography", "Plumbing",
      "Real Estate", "Research", "Sales", "Sports", "Tailoring",
      "Teaching", "Technology", "Tourism", "Translation", "Writing"
    ];

    // Populate category dropdown (only for admin)
    function populateCategories() {
      categorySelect.innerHTML = "";
      if (currentUser && currentUser.uid === adminUID) {
        categories.forEach(cat => {
          const option = document.createElement("option");
          option.value = cat;
          option.textContent = cat;
          categorySelect.appendChild(option);
        });
      } else {
        const option = document.createElement("option");
        option.value = "";
        option.textContent = "Category (admin only)";
        categorySelect.appendChild(option);
      }
    }

    // Auth
    loginBtn.addEventListener("click", () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    });

    logoutBtn.addEventListener("click", () => {
      auth.signOut();
    });

    auth.onAuthStateChanged(user => {
      if (user) {
        currentUser = user;
        loginBtn.style.display = "none";
        logoutBtn.style.display = "block";
        userPic.style.display = "block";
        userPic.src = user.photoURL;
        userName.textContent = user.displayName;
        populateCategories();
      } else {
        currentUser = null;
        loginBtn.style.display = "block";
        logoutBtn.style.display = "none";
        userPic.style.display = "none";
        userName.textContent = "";
        populateCategories();
      }
      loadSkills();
    });

    // Show/hide form
    addSkillBtn.addEventListener("click", () => {
      skillForm.style.display = skillForm.style.display === "none" ? "block" : "none";
    });

    // Save skill
    saveSkillBtn.addEventListener("click", async () => {
      if (!currentUser) return alert("Login first!");
      const skillData = {
        name: document.getElementById("name").value,
        skill: document.getElementById("skill").value,
        location: document.getElementById("location").value,
        whatsapp: document.getElementById("whatsapp").value,
        category: categorySelect.value,
        profilePic: document.getElementById("profilePic").value || currentUser.photoURL,
        userId: currentUser.uid,
        date: new Date().toLocaleDateString()
      };
      if (editingId) {
        await db.collection("skills").doc(editingId).update(skillData);
        editingId = null;
      } else {
        await db.collection("skills").add(skillData);
      }
      skillForm.reset();
      skillForm.style.display = "none";
      loadSkills();
    });

    // Load skills
    async function loadSkills() {
      skillsList.innerHTML = "";
      const snapshot = await db.collection("skills").get();
      snapshot.forEach(doc => {
        const data = doc.data();
        const div = document.createElement("div");
        div.className = "skill-card";
        div.innerHTML = `
          <img src="${data.profilePic}" alt="pic">
          <p><b>Name:</b> ${data.name}</p>
          <p><b>Skill:</b> ${data.skill}</p>
          <p><b>Location:</b> ${data.location}</p>
          <p><b>WhatsApp:</b> ${data.whatsapp}</p>
          <p><b>Date:</b> ${data.date}</p>
          ${currentUser && currentUser.uid === data.userId ? `
            <button class="editBtn" onclick="editSkill('${doc.id}')">Edit</button>
            <button class="deleteBtn" onclick="deleteSkill('${doc.id}')">Delete</button>
          ` : ""}
        `;
        skillsList.appendChild(div);
      });
    }

    // Edit skill
    window.editSkill = async function(id) {
      const docRef = await db.collection("skills").doc(id).get();
      const data = docRef.data();
      document.getElementById("name").value = data.name;
      document.getElementById("skill").value = data.skill;
      document.getElementById("location").value = data.location;
      document.getElementById("whatsapp").value = data.whatsapp;
      document.getElementById("profilePic").value = data.profilePic;
      categorySelect.value = data.category;
      editingId = id;
      skillForm.style.display = "block";
    }

    // Delete skill
    window.deleteSkill = async function(id) {
      await db.collection("skills").doc(id).delete();
      loadSkills();
    }

    // Search
    searchBar.addEventListener("input", () => {
      const term = searchBar.value.toLowerCase();
      document.querySelectorAll(".skill-card").forEach(card => {
        card.style.display = card.textContent.toLowerCase().includes(term) ? "block" : "none";
      });
    });
  </script>
</body>
</html>

